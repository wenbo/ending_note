# エンディングノート システム要件定義書

## 概要

デジタル版エンディングノート（終活ノート）システムの要件定義。ユーザーが自身の基本情報、緊急連絡先、家系図情報を記録・管理できるWebアプリケーションを開発する。

## ユーザストーリー

### ストーリー1: 基本情報の記録

- **である** 終活を考える人 **として**
- **私は** 自分の基本情報（名前、生年月日、住所、連絡先、宗教など）を記録 **したい**
- **そうすることで** 家族や関係者が必要な情報にアクセスできる

### ストーリー2: 緊急連絡先の管理

- **である** 家族の連絡手段を整理したい人 **として**
- **私は** 緊急時に連絡すべき人の情報（名前、関係、連絡先）を整理 **したい**
- **そうすることで** いざという時に適切な人に連絡してもらえる

### ストーリー3: 家系図の作成

- **である** 家族の歴史を残したい人 **として**
- **私は** 家系図を作成し、家族関係を視覚的に記録 **したい**
- **そうすることで** 後世に家族の系譜を伝えることができる

### ストーリー4: 情報の安全な保管

- **である** 個人情報を扱う利用者 **として**
- **私は** 記録した情報を安全に保管し、適切にアクセス制御 **したい**
- **そうすることで** プライベート情報の漏洩を防げる

## 機能要件（EARS記法）

### 通常要件

- REQ-001: システムは利用者の基本情報（名前、生年月日、血液型、住所、本籍、電話番号、メールアドレス、宗教、菩提寺）を入力・保存しなければならない
- REQ-002: システムは緊急連絡先情報（名前、関係、連絡先）を複数登録できなければならない
- REQ-003: システムは家系図情報を入力・表示できなければならない
- REQ-004: システムは入力された情報を編集・更新できなければならない
- REQ-005: システムは登録済み情報を一覧表示できなければならない

### 条件付き要件

- REQ-101: ユーザーがログインしている場合、システムは個人情報の閲覧・編集を許可しなければならない
- REQ-102: ユーザーが未ログインの場合、システムはログインページにリダイレクトしなければならない
- REQ-103: 必須項目が未入力の場合、システムはエラーメッセージを表示しなければならない
- REQ-104: 不正な形式のデータが入力された場合、システムはバリデーションエラーを表示しなければならない

### 状態要件

- REQ-201: データが保存中の状態にある場合、システムは保存処理中のインジケータを表示しなければならない
- REQ-202: システムがメンテナンス中の状態にある場合、システムはメンテナンス画面を表示しなければならない

### オプション要件

- REQ-301: システムはデータのエクスポート機能を提供してもよい
- REQ-302: システムはデータのバックアップ機能を提供してもよい
- REQ-303: システムは家系図の印刷機能を提供してもよい

### 制約要件

- REQ-401: システムは個人情報保護法に準拠しなければならない
- REQ-402: システムはHTTPS通信を使用しなければならない
- REQ-403: システムはパスワードを暗号化して保存しなければならない

## 非機能要件

### パフォーマンス

- NFR-001: システムは通常操作において3秒以内にレスポンスを返さなければならない
- NFR-002: システムは同時接続ユーザー数100人までの負荷に耐えられなければならない

### セキュリティ

- NFR-101: システムはユーザー認証機能を実装しなければならない
- NFR-102: システムはセッション管理を適切に行わなければならない
- NFR-103: システムは入力データのサニタイゼーションを行わなければならない
- NFR-104: システムはSQLインジェクション対策を実装しなければならない

### ユーザビリティ

- NFR-201: システムは直感的なユーザーインターフェースを提供しなければならない
- NFR-202: システムはモバイルデバイスに対応しなければならない
- NFR-203: システムは高齢者にも使いやすい大きめのフォントサイズを使用しなければならない

### 可用性

- NFR-301: システムは99%以上の稼働率を維持しなければならない
- NFR-302: システムは定期的なバックアップを実行しなければならない

## Edgeケース

### エラー処理

- EDGE-001: データベース接続エラーが発生した場合、適切なエラーメッセージを表示し、管理者に通知する
- EDGE-002: セッションタイムアウトが発生した場合、ログイン画面にリダイレクトする
- EDGE-003: 不正なアクセスが検出された場合、アクセスをブロックし、ログに記録する

### 境界値

- EDGE-101: 電話番号の桁数チェック（10-11桁の数字）
- EDGE-102: メールアドレス形式の検証（RFC準拠）
- EDGE-103: 生年月日の妥当性チェック（過去の日付のみ許可）
- EDGE-104: 文字数制限の実装（名前50文字、住所200文字など）

### データ整合性

- EDGE-201: 同時編集が発生した場合の排他制御
- EDGE-202: データ削除時の関連情報の整合性保持
- EDGE-203: 家系図の循環参照防止

## 受け入れ基準

### 機能テスト

- [ ] 基本情報の入力・保存・編集・削除ができる
- [ ] 緊急連絡先の追加・編集・削除ができる
- [ ] 家系図の作成・編集ができる
- [ ] ユーザー認証機能が正常に動作する
- [ ] バリデーション機能が適切に動作する
- [ ] エラーハンドリングが適切に実装されている

### 非機能テスト

- [ ] レスポンス時間が要件を満たしている
- [ ] セキュリティ要件が満たされている
- [ ] モバイルデバイスでの表示が適切である
- [ ] 負荷テストをクリアしている
- [ ] データバックアップ機能が動作する

### ユーザビリティテスト

- [ ] 高齢者を含む対象ユーザーが迷わず操作できる
- [ ] インターフェースが直感的で分かりやすい
- [ ] エラーメッセージが理解しやすい内容である

### セキュリティテスト

- [ ] 認証・認可機能が適切に動作する
- [ ] 個人情報の漏洩防止対策が実装されている
- [ ] 脆弱性スキャンをクリアしている
- [ ] HTTPS通信が正しく設定されている